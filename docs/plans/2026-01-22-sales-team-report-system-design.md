# Sales Team Report Management System Design
# å–¶æ¥­ãƒãƒ¼ãƒ å ±å‘Šç®¡ç†ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆæ›¸

**Date:** 2026-01-22
**Status:** Approved
**Author:** Claude AI + User

---

## 1. Overview (æ¦‚è¦)

### Scenario (ã‚·ãƒŠãƒªã‚ª)
- èª²é•· (Section Chief): 1å - å±±ç”°å¥ä¸€
- å–¶æ¥­æ‹…å½“ (Sales Reps): 3å - ç”°ä¸­å¤ªéƒã€ä½è—¤èŠ±å­ã€éˆ´æœ¨ä¸€éƒ
- å–¶æ¥­æ‹…å½“ã¯æ¯æ—¥é¡§å®¢ã‚’è¨ªå•ã—ã€å ±å‘Šæ›¸ã‚’ä½œæˆ
- èª²é•·ã¯éƒ¨ä¸‹ã®å ±å‘Šã‚’ç¢ºèªã—ã€æ‰¿èªã¾ãŸã¯æŒ‡ç¤ºã‚’å‡ºã™
- å–¶æ¥­æ‹…å½“ã¯æ‰¿èªæ¸ˆã¿å ±å‘Šã‚’AIæ±‡æ€»ã«ã¾ã¨ã‚ã‚‹

### Key Decisions (ä¸»è¦æ±ºå®šäº‹é …)
| Item | Decision |
|------|----------|
| Team Structure | Custom Sales_Team__c object (flexible for demo) |
| Report Workflow | Status workflow + Comment thread (complete) |
| Summary Feature | AI-assisted with manual editing |
| Data Visibility | Apex-based filtering (code-controlled) |

---

## 2. Data Model (ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«)

### Team_Member__c (ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼) - NEW
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Team_Member__c                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Name                     : Auto Number (TM-{0000})              â”‚
â”‚ Name__c                  : Text(80) - æ°å                      â”‚
â”‚ Email__c                 : Email                                â”‚
â”‚ Role__c                  : Picklist [èª²é•·, å–¶æ¥­]                 â”‚
â”‚ Manager__c               : Lookup(Team_Member__c) - ä¸Šå¸        â”‚
â”‚ Territory__c             : Text(100) - æ‹…å½“ã‚¨ãƒªã‚¢/æ¥­ç¨®          â”‚
â”‚ User__c                  : Lookup(User) - SF loginç”¨            â”‚
â”‚ Is_Active__c             : Checkbox (default: true)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Visit_Report__c (è¨ªå•å ±å‘Š) - EXTEND EXISTING
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Visit_Report__c (æ—¢å­˜ + æ‹¡å¼µ)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ (æ—¢å­˜ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰)                                                 â”‚
â”‚ - Account__c, Contact__c, Visit_Date__c                         â”‚
â”‚ - Summary__c, Discussion_Summary__c, Next_Actions__c            â”‚
â”‚ - Transcript__c, AI_Analysis__c, etc.                           â”‚
â”‚                                                                 â”‚
â”‚ (æ–°è¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰)                                                 â”‚
â”‚ + Reporter__c            : Lookup(Team_Member__c) - å ±å‘Šè€…       â”‚
â”‚ + Status__c              : Picklist [ä¸‹æ›¸ã, æå‡ºæ¸ˆ, æ‰¿èª, å·®æˆ»ã—] â”‚
â”‚ + Submitted_Date__c      : DateTime - æå‡ºæ—¥æ™‚                   â”‚
â”‚ + Approved_Date__c       : DateTime - æ‰¿èªæ—¥æ™‚                   â”‚
â”‚ + Is_Summarized__c       : Checkbox - æ±‡æ€»æ¸ˆã¿ãƒ•ãƒ©ã‚°             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Report_Comment__c (ã‚³ãƒ¡ãƒ³ãƒˆ/æŒ‡ç¤º) - NEW
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Report_Comment__c                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Name                     : Auto Number (RC-{0000})              â”‚
â”‚ Visit_Report__c          : Master-Detail(Visit_Report__c)       â”‚
â”‚ Author__c                : Lookup(Team_Member__c) - æŠ•ç¨¿è€…      â”‚
â”‚ Comment__c               : Long Text Area(10000) - ã‚³ãƒ¡ãƒ³ãƒˆå†…å®¹ â”‚
â”‚ Comment_Type__c          : Picklist [æŒ‡ç¤º, è¿”ä¿¡, ãƒ¡ãƒ¢]          â”‚
â”‚ CreatedDate              : DateTime (system)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Summary_Report__c (æ±‡æ€»å ±å‘Š) - NEW
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Summary_Report__c                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Name                     : Auto Number (SR-{0000})              â”‚
â”‚ Title__c                 : Text(255) - æ±‡æ€»ã‚¿ã‚¤ãƒˆãƒ«              â”‚
â”‚ Reporter__c              : Lookup(Team_Member__c) - ä½œæˆè€…      â”‚
â”‚ Period_Start__c          : Date - å¯¾è±¡æœŸé–“é–‹å§‹                  â”‚
â”‚ Period_End__c            : Date - å¯¾è±¡æœŸé–“çµ‚äº†                  â”‚
â”‚ Content__c               : Long Text Area(131072) - æ±‡æ€»å†…å®¹    â”‚
â”‚ Status__c                : Picklist [ä¸‹æ›¸ã, æå‡ºæ¸ˆ]            â”‚
â”‚ Report_Count__c          : Number - å«ã¾ã‚Œã‚‹å ±å‘Šæ•°              â”‚
â”‚ CreatedDate              : DateTime (system)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Summary_Report_Item__c (æ±‡æ€»-å ±å‘Šé–¢é€£) - NEW
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Summary_Report_Item__c                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Name                     : Auto Number (SRI-{0000})             â”‚
â”‚ Summary_Report__c        : Master-Detail(Summary_Report__c)     â”‚
â”‚ Visit_Report__c          : Lookup(Visit_Report__c)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ER Diagram
```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Team_Member__c  â”‚
                    â”‚   (ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Manager__c   â”‚ Reporter__c  â”‚ Author__c
              â–¼              â–¼              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Self   â”‚   â”‚Visit_Report â”‚  â”‚Report_Commentâ”‚
        â”‚(èª²é•·å‚ç…§)â”‚   â”‚  __c        â”‚  â”‚    __c       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ M-D
                             â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚Report_Commentâ”‚
                      â”‚     __c     â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚Visit_Report â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”‚Summary_Report   â”‚
        â”‚    __c      â”‚ Lookup  â”‚   _Item__c      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚ M-D
                                         â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚ Summary_Report  â”‚
                                â”‚      __c        â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Page Structure (ç”»é¢æ§‹æˆ)

### App Tabs
```
Sales Report App (å–¶æ¥­å ±å‘Šã‚¢ãƒ—ãƒª)
â”œâ”€â”€ ãƒ›ãƒ¼ãƒ  (Home)           â† Role-based content switching
â”œâ”€â”€ å ±å‘Šä½œæˆ (New Report)   â† Sales reps only
â”œâ”€â”€ å ±å‘Šä¸€è¦§ (Reports)      â† All users (filtered by role)
â”œâ”€â”€ æ±‡æ€» (Summary)          â† Sales: create, Manager: view
â””â”€â”€ ãƒãƒ¼ãƒ  (Team)           â† Manager only
```

### Page Flow - Sales Rep (å–¶æ¥­æ‹…å½“)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ãƒ›ãƒ¼ãƒ      â”‚â”€â”€â”€â”€â–¶â”‚  å ±å‘Šä½œæˆ   â”‚â”€â”€â”€â”€â–¶â”‚  å ±å‘Šä¸€è¦§   â”‚â”€â”€â”€â”€â–¶â”‚  æ±‡æ€»ä½œæˆ   â”‚
â”‚  (My Home)  â”‚     â”‚(New Report) â”‚     â”‚ (My List)   â”‚     â”‚ (Summary)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                   â”‚                   â”‚                   â”‚
      â”‚  ãƒ»ä»Šæ—¥ã®äºˆå®š      â”‚  ãƒ»éŸ³å£°å…¥åŠ›        â”‚  ãƒ»è‡ªåˆ†ã®å ±å‘Šã®ã¿   â”‚  ãƒ»è¤‡æ•°é¸æŠ
      â”‚  ãƒ»æœªæå‡ºå ±å‘Šæ•°    â”‚  ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—   â”‚  ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º   â”‚  ãƒ»AIè¦ç´„ç”Ÿæˆ
      â”‚  ãƒ»èª²é•·ã‹ã‚‰ã®æŒ‡ç¤º  â”‚  ãƒ»AIæ–‡å­—èµ·ã“ã—    â”‚  ãƒ»ã‚³ãƒ¡ãƒ³ãƒˆç¢ºèª     â”‚  ãƒ»ç·¨é›†ãƒ»ä¿å­˜
```

### Page Flow - Manager (èª²é•·)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ãƒãƒ¼ãƒ ç®¡ç†  â”‚â”€â”€â”€â”€â–¶â”‚  å ±å‘Šãƒ¬ãƒ“ãƒ¥ãƒ¼ â”‚â”€â”€â”€â”€â–¶â”‚  æ±‡æ€»ç¢ºèª   â”‚
â”‚(Team Dashboard)   â”‚  (Review)   â”‚     â”‚(View Summary)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                   â”‚                   â”‚
      â”‚  ãƒ»éƒ¨ä¸‹ä¸€è¦§        â”‚  ãƒ»å…¨å“¡ã®å ±å‘Š      â”‚  ãƒ»éƒ¨ä¸‹ã®æ±‡æ€»ç¢ºèª
      â”‚  ãƒ»æå‡ºçŠ¶æ³        â”‚  ãƒ»æ‰¿èª/å·®æˆ»ã—     â”‚  ãƒ»ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ 
      â”‚  ãƒ»çµ±è¨ˆã‚µãƒãƒªãƒ¼    â”‚  ãƒ»ã‚³ãƒ¡ãƒ³ãƒˆ/æŒ‡ç¤º   â”‚
```

---

## 4. Workflow (ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼)

### Report Lifecycle
```
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ä½œæˆé–‹å§‹  â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    ç·¨é›†
    â”‚  ä¸‹æ›¸ã   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  (Draft) â”‚          â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â”‚
         â”‚ æå‡º           â”‚
         â–¼               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
    â”‚  æå‡ºæ¸ˆ   â”‚          â”‚
    â”‚(Submitted)â”‚          â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜          â”‚
         â”‚               â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”          â”‚
    â–¼         â–¼          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”       â”‚
â”‚ æ‰¿èª  â”‚  â”‚ å·®æˆ»ã— â”‚â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚(Approved) â”‚(Rejected)â”‚ (ä¿®æ­£ä¾é ¼)
â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ±‡æ€»å¯¾è±¡  â”‚ â† Is_Summarized__c = false ã®æ‰¿èªæ¸ˆã¿å ±å‘Š
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Permission Matrix
| Action | Sales (Own) | Sales (Others) | Manager |
|--------|-------------|----------------|---------|
| Create Report | âœ… | âŒ | âŒ |
| Edit (Draft) | âœ… | âŒ | âŒ |
| Submit | âœ… | âŒ | âŒ |
| Approve/Reject | âŒ | âŒ | âœ… |
| Add Comment | âœ… | âŒ | âœ… |
| Include in Summary | âœ… (Approved only) | âŒ | âŒ |
| View Summary | âœ… (Own) | âŒ | âœ… (All) |

### Notification Triggers
- Sales submits report â†’ Notify Manager
- Manager rejects â†’ Notify Sales (with comment)
- Manager approves â†’ Notify Sales

---

## 5. Summary Report Feature (æ±‡æ€»æ©Ÿèƒ½)

### Creation Flow
```
Step 1: Report Selection
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â˜‘ 2024/01/15 - ABCæ ªå¼ä¼šç¤¾ - è£½å“ãƒ‡ãƒ¢å®Ÿæ–½                   â”‚
â”‚ â˜‘ 2024/01/16 - XYZå•†äº‹ - è¦‹ç©ã‚‚ã‚Šæå‡º                       â”‚
â”‚ â˜ 2024/01/17 - DEFå·¥æ¥­ - åˆå›è¨ªå• (æ±‡æ€»æ¸ˆã¿)                â”‚
â”‚ â˜‘ 2024/01/18 - GHIéŠ€è¡Œ - å¥‘ç´„äº¤æ¸‰                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
[é¸æŠ: 3ä»¶]                                    [AIæ±‡æ€»ã‚’ç”Ÿæˆ]

Step 2: AI Generation (Claude API)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”„ é¸æŠã•ã‚ŒãŸ3ä»¶ã®å ±å‘Šã‚’åˆ†æä¸­...                           â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 60%                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 3: Edit & Save
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã€é€±æ¬¡å–¶æ¥­æ´»å‹•ã‚µãƒãƒªãƒ¼ã€‘                                      â”‚
â”‚                                                             â”‚
â”‚ â–  æ´»å‹•æ¦‚è¦                                                  â”‚
â”‚   - è¨ªå•ä»¶æ•°: 3ä»¶                                           â”‚
â”‚   - æ–°è¦æ¡ˆä»¶: 1ä»¶ (GHIéŠ€è¡Œ)                                 â”‚
â”‚                                                             â”‚
â”‚ â–  ä¸»ãªæˆæœ                                                  â”‚
â”‚   - ABCæ ªå¼ä¼šç¤¾: ãƒ‡ãƒ¢å¥½è©•ã€æ¬¡å›ææ¡ˆäºˆå®š                       â”‚
â”‚   - XYZå•†äº‹: è¦‹ç©ã‚‚ã‚Šæå‡ºæ¸ˆã€æ¥é€±å›ç­”äºˆå®š                     â”‚
â”‚                                               [ç·¨é›†å¯èƒ½]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
[å†ç”Ÿæˆ] [ä¸‹æ›¸ãä¿å­˜] [æå‡º]
```

### AI Prompt Template
```
ä»¥ä¸‹ã®å–¶æ¥­è¨ªå•å ±å‘Šã‚’ã‚‚ã¨ã«ã€é€±æ¬¡/æœˆæ¬¡ã®å–¶æ¥­æ´»å‹•ã‚µãƒãƒªãƒ¼ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

ã€è¦ç´„ã«å«ã‚ã‚‹é …ç›®ã€‘
1. æ´»å‹•æ¦‚è¦ï¼ˆè¨ªå•ä»¶æ•°ã€æœŸé–“ï¼‰
2. ä¸»ãªæˆæœãƒ»é€²æ—
3. èª²é¡Œãƒ»æ‡¸å¿µäº‹é …
4. æ¬¡é€±ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³äºˆå®š
5. ç‰¹è¨˜äº‹é …

ã€å ±å‘Šãƒ‡ãƒ¼ã‚¿ã€‘
{reports_json}

æ—¥æœ¬èªã§ã€ç°¡æ½”ã‹ã¤å…·ä½“çš„ã«ã¾ã¨ã‚ã¦ãã ã•ã„ã€‚
```

---

## 6. Technical Components (æŠ€è¡“ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ)

### New LWC Components
```
lwc/
â”œâ”€â”€ salesTeamHome/            â† Home screen (role-based)
â”œâ”€â”€ teamReportList/           â† Report list with filters
â”œâ”€â”€ reportDetail/             â† Report detail & review
â”œâ”€â”€ reportComments/           â† Comment thread component
â”œâ”€â”€ summaryCreator/           â† Summary creation screen
â””â”€â”€ summaryViewer/            â† Summary view screen
```

### New/Modified Apex Classes
```
classes/
â”œâ”€â”€ TeamMemberController.cls      â† Team member CRUD
â”‚   â””â”€â”€ getCurrentMember()
â”‚   â””â”€â”€ getTeamMembers(managerId)
â”‚   â””â”€â”€ isManager(userId)
â”‚
â”œâ”€â”€ VisitReportController.cls     â† Extend existing
â”‚   â””â”€â”€ getMyReports(memberId)
â”‚   â””â”€â”€ getTeamReports(managerId)
â”‚   â””â”€â”€ submitReport(reportId)
â”‚   â””â”€â”€ approveReport(reportId)
â”‚   â””â”€â”€ rejectReport(reportId, comment)
â”‚
â”œâ”€â”€ ReportCommentController.cls   â† Comment management
â”‚   â””â”€â”€ getComments(reportId)
â”‚   â””â”€â”€ addComment(reportId, content, type)
â”‚
â””â”€â”€ SummaryReportController.cls   â† Summary management
    â””â”€â”€ getAvailableReports(memberId)
    â””â”€â”€ generateSummary(reportIds)  â† Claude API call
    â””â”€â”€ saveSummary(summaryData)
    â””â”€â”€ getMySummaries(memberId)
    â””â”€â”€ getTeamSummaries(managerId)
```

### Reused Existing Components
```
â”œâ”€â”€ voiceInput         â† Voice input (existing)
â”œâ”€â”€ audioUploader      â† File upload with chunking (existing)
â”œâ”€â”€ ClaudeAPIService   â† AI API call (existing)
â””â”€â”€ WhisperAPIService  â† Transcription (existing)
```

---

## 7. Demo Data (ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿)

### Team Members
| Name | Role | Manager | Territory |
|------|------|---------|-----------|
| å±±ç”°å¥ä¸€ (Yamada Kenichi) | èª²é•· | - | æ±æ—¥æœ¬å–¶æ¥­éƒ¨ |
| ç”°ä¸­å¤ªéƒ (Tanaka Taro) | å–¶æ¥­ | å±±ç”°å¥ä¸€ | æ±äº¬ã‚¨ãƒªã‚¢ |
| ä½è—¤èŠ±å­ (Sato Hanako) | å–¶æ¥­ | å±±ç”°å¥ä¸€ | å¤§é˜ªã‚¨ãƒªã‚¢ |
| éˆ´æœ¨ä¸€éƒ (Suzuki Ichiro) | å–¶æ¥­ | å±±ç”°å¥ä¸€ | åå¤å±‹ã‚¨ãƒªã‚¢ |

### Sample Reports per Rep
- ç”°ä¸­: 5 reports (2 approved, 2 submitted, 1 draft)
- ä½è—¤: 4 reports (3 approved, 1 submitted)
- éˆ´æœ¨: 3 reports (1 approved, 1 rejected, 1 draft)

---

## 8. Implementation Order (å®Ÿè£…é †åº)

### Phase 1: Data Foundation
1. Create Team_Member__c object
2. Add new fields to Visit_Report__c
3. Create Report_Comment__c object
4. Create Summary_Report__c and Summary_Report_Item__c
5. Insert demo data

### Phase 2: Core Components
6. TeamMemberController.cls
7. Extend VisitReportController.cls
8. salesTeamHome LWC
9. teamReportList LWC

### Phase 3: Workflow Features
10. ReportCommentController.cls
11. reportDetail LWC
12. reportComments LWC
13. Status change functionality

### Phase 4: Summary Feature
14. SummaryReportController.cls
15. summaryCreator LWC
16. summaryViewer LWC
17. AI integration for summary generation

### Phase 5: Polish & Deploy
18. Flexipage layouts
19. Permission sets
20. Testing & deployment

---

## Appendix: Full User Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            LOGIN                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  å–¶æ¥­ãƒ›ãƒ¼ãƒ ç”»é¢    â”‚           â”‚  èª²é•·ãƒ›ãƒ¼ãƒ ç”»é¢    â”‚
        â”‚  (Sales Home)     â”‚           â”‚  (Manager Home)   â”‚
        â”‚                   â”‚           â”‚                   â”‚
        â”‚ ãƒ»æœªæå‡º: 2ä»¶     â”‚           â”‚ ãƒ»æå‡ºå¾…ã¡: 5ä»¶   â”‚
        â”‚ ãƒ»å·®æˆ»ã—: 1ä»¶     â”‚           â”‚ ãƒ»ç”°ä¸­: 2ä»¶       â”‚
        â”‚ ãƒ»ä»Šé€±è¨ªå•: 5ä»¶   â”‚           â”‚ ãƒ»ä½è—¤: 2ä»¶       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ ãƒ»éˆ´æœ¨: 1ä»¶       â”‚
                â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
    â–¼           â–¼           â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚æ–°è¦ä½œæˆâ”‚ â”‚å ±å‘Šä¸€è¦§ â”‚ â”‚æ±‡æ€»ä½œæˆ â”‚       â”‚ ãƒãƒ¼ãƒ å ±å‘Š  â”‚
â”‚       â”‚ â”‚(è‡ªåˆ†ã®) â”‚ â”‚        â”‚       â”‚   ä¸€è¦§      â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
    â”‚          â”‚          â”‚                    â”‚
    â–¼          â–¼          â”‚                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å ±å‘Šä½œæˆç”»é¢   â”‚        â”‚            â”‚ å ±å‘Šè©³ç´°    â”‚
â”‚                â”‚        â”‚            â”‚ (ãƒ¬ãƒ“ãƒ¥ãƒ¼)  â”‚
â”‚ [éŸ³å£°å…¥åŠ›]     â”‚        â”‚            â”‚             â”‚
â”‚ [ãƒ•ã‚¡ã‚¤ãƒ«]     â”‚        â”‚            â”‚ [æ‰¿èª]      â”‚
â”‚ [æ‰‹å‹•å…¥åŠ›]     â”‚        â”‚            â”‚ [å·®æˆ»ã—]    â”‚
â”‚                â”‚        â”‚            â”‚ [ã‚³ãƒ¡ãƒ³ãƒˆ]  â”‚
â”‚ [ä¸‹æ›¸ãä¿å­˜]   â”‚        â”‚            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
â”‚ [æå‡º]        â”‚        â”‚                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                â”‚            â–¼               â–¼
        â–¼                â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚      â”‚ æ‰¿èªå®Œäº† â”‚    â”‚å·®æˆ»ã—   â”‚
â”‚  æå‡ºå®Œäº†   â”‚          â”‚      â”‚â†’å–¶æ¥­é€šçŸ¥â”‚    â”‚+ã‚³ãƒ¡ãƒ³ãƒˆâ”‚
â”‚  â†’èª²é•·é€šçŸ¥ â”‚          â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚â†’å–¶æ¥­é€šçŸ¥â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   æ±‡æ€»ä½œæˆç”»é¢   â”‚
              â”‚                 â”‚
              â”‚ â˜‘å ±å‘Š1 â˜‘å ±å‘Š2  â”‚
              â”‚ [AIç”Ÿæˆ]        â”‚
              â”‚       â†“        â”‚
              â”‚ [ç·¨é›†ã‚¨ãƒªã‚¢]    â”‚
              â”‚       â†“        â”‚
              â”‚ [ä¿å­˜] [æå‡º]   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
